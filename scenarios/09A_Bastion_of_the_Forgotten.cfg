#textdomain wesnoth-Electrifyre

[scenario]
    id=09A_Bastion_of_the_Forgotten
    name=_"Bastion of the Forgotten"
    next_scenario=09X_Epilogue

    map_file=09A_Bastion_of_the_Forgotten.map

    victory_when_enemies_defeated=no
    turns=-1
    {CAMPAIGN_XP_MODIFIER}

    {DEFAULT_MUSIC_PLAYLIST}
    {UNDERGROUND}

    {STORY_NINE_A}

    # side: player
    [side]
        side=1
        controller=human
        
        {CHARACTER_STATS:HIKARU}
        facing=se

        {FACTION_SIDE:ARAGWAITHI}
        recruit={RECRUITS:ARAGWAITHI}

        fog=yes
        shroud=yes
        share_vision=all

        {GOLD 400 400 350}
        {INCOME  2  1  0}
    [/side]

    # side: deep elves
    [side]
        side=2
        controller=ai
        
        id="Vanleneada"
        name=_"Vanleneada"
        type="Seer"
        profile="portraits/seer.png"
        canrecruit=yes
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_INTELLIGENT}
        [/modifications]

        {FACTION_SIDE:DEEP_ELVES}

        {GOLD 380 360 340}
        {INCOME 34 36 38}

        fog=yes
        shroud=yes
        share_vision=all

        recruit="Baroness of the Night, Matriarch, Seer, Vengeance, Shadow Tyrhai, Forgotten Minotaur, Tyrhai Cavalry"

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.65}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }
        [/ai]
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 ("Forgotten Minotaur") ({ON_DIFFICULTY  3  2  2})}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 ("Vengeance") ({ON_DIFFICULTY  3  2  2})}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 ("Matriarch") ({ON_DIFFICULTY  3  2  2})}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 ("Seer") ({ON_DIFFICULTY  3  2  2})}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 ("Tyrhai Cavalry") ({ON_DIFFICULTY  3  2  2})}

    # side: valefolk
    [side]
        side=3
        controller=ai
        no_leader=yes

        {FACTION_SIDE:VALEFOLK}

        {GOLD 440 450 480}
        {INCOME 34 34 36}
        {HIDDEN_SIDE}

        recruit={RECRUITS:VALEFOLK_ELITES_ONLY}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }
        [/ai]
    [/side]

    # side: valefolk
    [side]
        side=4
        controller=ai
        no_leader=yes

        {FACTION_SIDE:VALEFOLK}

        {GOLD 440 450 480}
        {INCOME 34 34 36}
        {HIDDEN_SIDE}

        recruit={RECRUITS:VALEFOLK_ELITES_ONLY}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }
        [/ai]
    [/side]

    # side: valefolk
    [side]
        side=5
        controller=ai
        no_leader=yes

        {FACTION_SIDE:VALEFOLK}

        {GOLD 70 90 120}
        {INCOME 24 26 28}
        {HIDDEN_SIDE}

        recruit={RECRUITS:NIGHTMARES_ELITES}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }
        [/ai]
    [/side]

    # side: valefolk
    # stationed guards 
    [side]
        side=6
        controller=ai
        no_leader=yes

        {FACTION_SIDE:VALEFOLK}

        {NO_ECONOMY}
        {NO_RECRUITMENT}
        {HIDDEN_SIDE}
    [/side]

    # side: dwarves
    [side]
        side=7
        controller=ai
        no_leader=yes

        {FACTION_SIDE:DWARVES}

        {GOLD 70 90 120}
        {INCOME 24 26 28}
        {HIDDEN_SIDE}

        recruit={RECRUITS:DWARVES_ELITES_ONLY}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }
        [/ai]
    [/side]

    # side: dwarves
    [side]
        side=8
        controller=ai
        no_leader=yes

        {FACTION_SIDE:DWARVES}

        {GOLD 70 90 120}
        {INCOME 24 26 28}
        {HIDDEN_SIDE}

        recruit={RECRUITS:DWARVES_ELITES_ONLY}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }
        [/ai]
    [/side]

    # side: valefolk
    [side]
        side=9
        controller=ai
        no_leader=yes

        {FACTION_SIDE:VALEFOLK}

        {GOLD 70 90 120}
        {INCOME 24 26 28}
        {HIDDEN_SIDE}

        recruit={RECRUITS:NIGHTMARES_ELITES}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }
        [/ai]
    [/side]

    # side: dungeon monsters
    [side]
        side=10
        controller=ai
        no_leader=yes

        team_name="valefolk"
        user_team_name=_"Monsters"
        {FLAG_VARIANT6 ragged}
        color=brown

        {NO_ECONOMY}
        {NO_RECRUITMENT}
        {HIDDEN_SIDE}
    [/side]

    # side: prisoners
    [side]
        side=11
        controller=ai
        no_leader=yes

        team_name="aragwaithi"
        user_team_name=_"Drakes"
        {FLAG_VARIANT long}
        color=red

        fog=yes
        shroud=yes
        share_vision=none

        {NO_ECONOMY}
        {NO_RECRUITMENT}
        {HIDDEN_SIDE}
    [/side]

    # place some weapon items here
    # kind of ties to the scenario 5
    # where it's been stated
    # they stole a lot of weapons from
    # a lot of aragwaithi villages
    # and also from other places
    {PLACE_IMAGE "items/staff-magic-2.png" 27 2}
    {PLACE_IMAGE "items/hammer-runic.png" 28 3}
    {PLACE_IMAGE "items/talisman-ankh.png" 18 3}
    {PLACE_IMAGE "items/sword-wraith.png" 19 2}
    {PLACE_IMAGE "items/bow-crystal-2.png" 22 9}
    {PLACE_IMAGE "items/storm-trident-2.png" 24 9}

    # prestart event
    [event]
        name="prestart"

        {RECALL Soryu}
        {RECALL Eikichi}
        {RECALL Ryuuma}

        # adjust recall costs
        {ADJUST_RECALL_COST 33 50 66}

        # objectives
        [objectives]
            side=1
            silent=no

            [objective]
                caption=_"Objective I"
                description=_"Find and disable the mechanism of the bridge"
                condition="win"
            [/objective]
            [objective]
                caption=_"Objective II"
                description=_"Hold off the enemy forces"
                condition="win"
            [/objective]

            {PLAYER_LEADER_DEATH_OBJECTIVE}
            [objective]
                description=_"Death of Ryuuma"
                condition="lose"
            [/objective]
            [objective]
                description=_"Death of Vanleneada"
                condition="lose"
            [/objective]

            [gold_carryover]
                bonus=yes
                carryover_percentage=0
            [/gold_carryover]

            # add hints
            {IS_LAST_SCENARIO}
            {HAS_NO_TURN_LIMIT}
            [note]
                description=_"You are severely outnumbered."
            [/note]
            [note]
                description=_"Recall costs are a fraction of the recruit cost."
            [/note]
            [note]
                description=_"Right-Click on Hikaru or Ryuuma to see How to Play Guide."
            [/note]
            [note]
                description=_"The devices that was keeping the bridge active are enemy units."
            [/note]
        [/objectives]

        # spawn valefolk leaders
        [unit]
            side=3
            x,y=7,15
            type=Vale Priestess
            [modifications]
                {TRAIT_SUPREME}
                {TRAIT_RESILIENT}
            [/modifications]
            id="Valefolk_Commander1"
            generate_name=yes
            canrecruit=yes
            [status]
                invulnerable=yes
            [/status]
        [/unit]

        [unit]
            side=3
            x,y=40,17
            type=Vale Priestess
            [modifications]
                {TRAIT_SUPREME}
                {TRAIT_RESILIENT}
            [/modifications]
            id="Valefolk_Commander2"
            generate_name=yes
            canrecruit=yes
            [status]
                invulnerable=yes
            [/status]
        [/unit]

        [unit]
            side=4
            x,y=20,14
            type=Vale Priestess
            [modifications]
                {TRAIT_SUPREME}
                {TRAIT_RESILIENT}
            [/modifications]
            id="Valefolk_Commander3"
            generate_name=yes
            canrecruit=yes
            [status]
                invulnerable=yes
            [/status]
        [/unit]

        [unit]
            side=4
            x,y=26,14
            type=Vale Priestess
            [modifications]
                {TRAIT_SUPREME}
                {TRAIT_RESILIENT}
            [/modifications]
            id="Valefolk_Commander4"
            generate_name=yes
            canrecruit=yes
            [status]
                invulnerable=yes
            [/status]
        [/unit]

        # two subcommanders
        [unit]
            side=5
            x,y=41,23
            type="Necromancer"
            gender=female
            generate_name=yes
            id="Vale_Subcommander1"
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_STRONG}
            [/modifications]
            canrecruit=yes
        [/unit]

        [unit]
            side=9
            x,y=9,41
            type="Necromancer"
            gender=male
            generate_name=yes
            id="Vale_Subcommander2"
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_STRONG}
            [/modifications]
            canrecruit=yes
        [/unit]

        # spawn dwarven leaders
        [unit]
            side=7
            x,y=6,23
            type="Dwarvish Sentinel"
            generate_name=yes
            id="Dwarf_Commander1"
            [modifications]
                {TRAIT_HEALTHY}
                {TRAIT_STRONG}
            [/modifications]
            canrecruit=yes
        [/unit]

        [unit]
            side=8
            x,y=40,40
            type="Dwarvish Sentinel"
            generate_name=yes
            id="Dwarf_Commander2"
            [modifications]
                {TRAIT_HEALTHY}
                {TRAIT_STRONG}
            [/modifications]
            canrecruit=yes
        [/unit]

        # spawn guard units
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 19 32}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 20 32}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 21 33}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 22 33}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 23 34}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 26 33}

        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 20 31}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 22 32}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 23 33}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 21 27}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 22 26}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 23 26}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 24 25}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 25 25}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Sentinel") 26 24}

        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 21 26}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 23 25}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 25 24}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Lord") 18 20}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Lord") 19 21}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Lord") 20 20}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Lord") 22 20}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Lord") 24 19}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Lord") 26 20}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Dragonguard") 28 20}

        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 19 20}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 22 19}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 26 19}

        {GENERIC_STATIONED_UNIT 6 ("Vale Purifier") 21 20}
        {GENERIC_STATIONED_UNIT 6 ("Vale Purifier") 23 20}
        {GENERIC_STATIONED_UNIT 6 ("Vale Purifier") 25 20}
        {GENERIC_STATIONED_UNIT 6 ("Vale Purifier") 27 20}

        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 36 23}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess") 37 26}
        {GENERIC_STATIONED_UNIT 6 ("Vale Priestess")  8 29}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 34 47}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 35 47}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 37 49}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 38 48}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 35 45}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 36 44}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 38 46}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 39 46}
        
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 31 27}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 33 27}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 33 24}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 35 24}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 36 25}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 36 26}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 36 24}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  4 27}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  6 27}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  4 30}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  5 32}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  4 31}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  7 29}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  7 30}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard")  8 30}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 11 23}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 11 25}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 12 25}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 12 26}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 13 28}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 15 25}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Thunderguard") 15 26}

        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Stalwart")  6 35}
        {GENERIC_STATIONED_UNIT 6 ("Dwarvish Stalwart")  7 36}

        [unit]
            side=6
            x,y=10,39
            id="Conduit1"
            type="Defender Conduit"
            ai_special=guardian
            {IS_HERO}
        [/unit]

        [unit]
            side=6
            x,y=5,22
            id="Conduit2"
            type="Defender Conduit"
            ai_special=guardian
            {IS_HERO}
        [/unit]

        [unit]
            side=6
            x,y=42,21
            id="Conduit3"
            type="Defender Conduit"
            ai_special=guardian
            {IS_HERO}
        [/unit]

        [unit]
            side=6
            x,y=41,39
            id="Conduit4"
            type="Defender Conduit"
            ai_special=guardian
            {IS_HERO}
        [/unit]

        [unit]
            side=6
            x,y=25,29
            id="Conduit5"
            type="Attacker Conduit"
            ai_special=guardian
            {IS_HERO}
        [/unit]

        [unit]
            side=6
            x,y=21,36
            id="Conduit6"
            type="Attacker Conduit"
            ai_special=guardian
            {IS_HERO}
        [/unit]

        # define scenario progression
        # control variable
        {VARIABLE S9A_conduits_destroy_count 6}

        # prisoners
        [unit]
            side=11
            x,y=2,33
            type="Drake Caster"
            facing=se
            id="Verra"
            name=_"Verra"
            hitpoints={ON_DIFFICULTY 16 8 2}
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            [status]
                unhealable=yes
            [/status]
        [/unit]

        [unit]
            side=11
            x,y=3,38
            type="Drake Adventurer"
            id="Grashen"
            name=_"Grashen"
            gender=male
            facing=sw
            hitpoints={ON_DIFFICULTY 16 8 2}
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_STRONG}
            [/modifications]
            [status]
                unhealable=yes
            [/status]
        [/unit]

        [unit]
            side=11
            x,y=11,35
            type="Drake Smasher"
            id="Orrida"
            name=_"Orrida"
            gender=male
            facing=se
            hitpoints={ON_DIFFICULTY 16 8 2}
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_FEARLESS}
            [/modifications]
            [status]
                unhealable=yes
            [/status]
        [/unit]

        {VARIABLE S9A_prisoners_freed 0}
    [/event]

    # enable micro AI event
    [event]
        name="turn_2"
        id="S9A_enabled_micro_ai"

        # side 2: deep elves
        [micro_ai]
            side=2
            ai_type=zone_guardian
            action=add

            [filter]
                side=2
                canrecruit=no
            [/filter]
            [filter_location]
                x=18-27
                y=23-45
            [/filter_location]
        [/micro_ai]

        # side 3
        [micro_ai]
            side=3
            ai_type=zone_guardian
            action=add

            [filter]
                side=3
                canrecruit=no
            [/filter]
            [filter_location]
                x=7-41,18-27
                y=10-20,23-28
            [/filter_location]
        [/micro_ai]

        # side 4
        [micro_ai]
            side=4
            ai_type=zone_guardian
            action=add

            [filter]
                side=4
                canrecruit=no
            [/filter]
            [filter_location]
                x=18-27
                y=23-45
            [/filter_location]
        [/micro_ai]

        # side 5
        [micro_ai]
            side=5
            ai_type=zone_guardian
            action=add

            [filter]
                side=5
                canrecruit=no
            [/filter]
            [filter_location]
                x=35,   36,   37,   38,   38,   39,   40,   41,   42,   37,   36,   35
                y=24,23-26,23-26,22-25,28-31,23-31,22-28,23-26,23-25,31-32,31-32,31-32
            [/filter_location]
        [/micro_ai]

        # side 7
        [micro_ai]
            side=7
            ai_type=zone_guardian
            action=add

            [filter]
                side=7
                canrecruit=no
            [/filter]
            [filter_location]
                x=    4,    5,    6,    7,    8,    9,   10,11,11,   10,   11,   12,   13,   14,15
                y=25-27,24-27,23-27,23-26,23-26,23-28,23-24,23,25,26-29,28-30,29-30,30-31,29-30,30
            [/filter_location]
        [/micro_ai]

        # side 8
        [micro_ai]
            side=8
            ai_type=zone_guardian
            action=add

            [filter]
                side=8
                canrecruit=no
            [/filter]
            [filter_location]
                x=35,   36,   36,   37,37,   37,   38,   39,   40,   41,   42
                y=47,47-48,44-45,41-42,45,48-49,40-46,40-46,40-43,41-44,42-43
            [/filter_location]
        [/micro_ai]

        # side 9
        [micro_ai]
            side=9
            ai_type=zone_guardian
            action=add

            [filter]
                side=9
                canrecruit=no
            [/filter]
            [filter_location]
                x=    5,    6,    7,    8,    9,10,    6,    9, 5,   10,   11
                y=41-42,40-42,41-47,40-46,41-43,41,45-47,46-47,47,46-47,47-48
            [/filter_location]
        [/micro_ai]
    [/event]

    # start event
    [event]
        name="start"

        {SIMPLE_MSG "Vanleneada" (_"Ah, their fortress lies just beyond the massive cave platform. It seems they have taken measures against us and have stationed what remains of their forces in the ancient fortifications.")}

        {SIMPLE_MSG "Ryuuma" (_"Indeed, they have. As much as I would like to disrupt what foul ritual they are performing with the stolen artifacts, it seems we have to change plans.")}

        {SIMPLE_MSG "Hikaru" (_"Why so, Lord Ryuuma?")}

        {SIMPLE_MSG "Ryuuma" (_"Compared to the size of our intial armies, our numbers have dwindled considerably. What we have right now are the last of our forces.")}

        {SIMPLE_MSG "Soryu" (_"In comparison, the enemy forces seem to be endless.")}

        {SIMPLE_MSG "Ryuuma" (_"This is why I think it is better to find some alternative solution to our current problem.")}

        {SIMPLE_MSG "Vanleneada" (_"My sisters tell me that there is indeed an alternative and more effective way to thwart the enemy.")}

        {SIMPLE_MSG "Vanleneada" (_"The only way in and out of this fortress for most of their forces is via this massive cave platform. The strange thing is, this platform was not there before. There was giant chasm here.")}

        {SIMPLE_MSG "Vanleneada" (_"This surmises that there must be a mechanism controlling the platform being here. You should find and disable the mechanism.")}

        {SIMPLE_MSG "Hikaru" (_"That just might work. Let us mobilize our forces!")}
    [/event]

    # turn 2
    [event]
        name="side 1 turn 2"

        {SIMPLE_MSG "Hikaru" (_"Remember, our allies will be fighting the valefolk head on. It's up to us to find and disable the mechanism!")}
    [/event]

    [event]
        name="side 2 turn 2"

        {SIMPLE_MSG "Vanleneada" (_"Sisters, let us show these dwarves and their wretched allies that they should not have crossed weapons with us!")}
    [/event]

    # turn 3: give hint
    [event]
        name="side 2 turn 3"

        {SIMPLE_MSG "Soryu" (_"There will be a lot of ground to cover. Those disabling devices might be anywere.")}

        {SIMPLE_MSG "Vanleneada" (_"We can assist in that regard. Let me do a seeking spell.")}

        #  [animate_unit]
        #      [filter]
        #          id="Vanleneada"
        #      [/filter]

        #      flag=attack
        #      hits=no
        #      [primary_attack]
        #          range=ranged
        #      [/primary_attack]
        #  [/animate_unit]
        #  {SCROLL_TO 25 29}
        #  [delay]
        #      time=200
        #  [/delay]
        #  [remove_shroud]
        #      side=1,2
        #      x,y=25,29
        #      radius=1
        #  [/remove_shroud]
        #  [redraw]
        #  [/redraw]
        [lua]
            code = <<
            wesnoth.dofile("~add-ons/Electrifyre/lua/scenarios/S9A_hint_wisps.lua")
            >>
        [/lua]

        {SIMPLE_MSG "Vanleneada" (_"The locations of the devices have been revealed!")}

        {SIMPLE_MSG "Hikaru" (_"Excellent. Now, we know where to coordinate our efforts.")}
    [/event]

    # death events for valefolk side subcommanders
    [event]
        name="last breath"
        [filter]
            id="Vale_Subcommander1"
        [/filter]

        {SIMPLE_MSG unit (_"You may have ended me, but no matter what you do, the ritual cannot be interrupted!")}
    [/event]

    [event]
        name="last breath"
        [filter]
            id="Vale_Subcommander2"
        [/filter]

        {SIMPLE_MSG unit (_"Ouch! We really should have taken you seriously!")}
    [/event]

    [event]
        name="last breath"
        [filter]
            id="Dwarf_Commander1"
        [/filter]

        {SIMPLE_MSG unit (_"Curse you, surface-dweller! Da beard of a dwarf is worth more than yer puny life!")}
    [/event]

    [event]
        name="last breath"
        [filter]
            id="Dwarf_Commander2"
        [/filter]

        {SIMPLE_MSG unit (_"You think this ends it, do ye? Da stones of our halls will weep for ye when ye face the wrath of our kin!")}
    [/event]

    # event: make one of the high mages spawn
    # at intervals to continue the scenario
    # atmosphere
    [event]
        name="turn 5"

        [remove_shroud]
            side=1,2
            x=23,28
            y=15,2
            radius=1
        [/remove_shroud]
        [lift_fog]
            side=1,2
            x=23,28
            y=15,2
            radius=1
        [/lift_fog]
        [redraw]
        [/redraw]

        {SCROLL_TO 23 15}

        [unit]
            side=6
            x,y=23,15
            id="Moirafina"
            name=_"Moirafina"
            type="Mage of Nature"
            {IS_HERO}
            [modifications]
                {TRAIT_SUPREME}
                {TRAIT_INTELLIGENT}
            [/modifications]
        [/unit]

        {GENERIC_UNIT 6 "Earth Daemon" 23 15}
        {GENERIC_UNIT 6 "Earth Daemon" 23 15}
        {GENERIC_UNIT 6 "Earth Daemon" 23 15}
        {GENERIC_UNIT 6 "Earth Daemon" 23 15}
        {GENERIC_UNIT 6 "Earth Daemon" 23 15}
        {GENERIC_UNIT 6 "Earth Daemon" 23 15}

        {SIMPLE_MSG "Moirafina" (_"It's almost time for the ritual to commence. The other high mages are on their way.")}

        {SIMPLE_MSG "Moirafina" (_"Prietess, do not allow the Aragwaithi or the Deep Elves to disrupt what we are doing no matter the cost.")}

        {TELEPORT_UNIT (id="Moirafina") 28 2}

        {UNIT_MSG (
            side=3
            canrecruit=yes
        ) (_"Yes, Lady Moirafina! No Aragwaith or Elf shall set foot inside the citadel!")}

        [place_shroud]
            side=1,2
            x=23
            y=15
            radius=1
        [/place_shroud]
        [reset_fog]
            side=1,2
            x=23,28
            y=15,2
            radius=1
        [/reset_fog]
        [redraw]
        [/redraw]
    [/event]

    [event]
        name="turn 10"

        [remove_shroud]
            side=1,2
            x=23,18
            y=15,2
            radius=1
        [/remove_shroud]
        [lift_fog]
            side=1,2
            x=23,18
            y=15,2
            radius=1
        [/lift_fog]
        [redraw]
        [/redraw]

        {SCROLL_TO 23 15}

        [unit]
            side=6
            x,y=23,15
            id="Ojareth"
            name=_"Ojareth"
            type="Mage of Storms"
            {IS_HERO}
            [modifications]
                {TRAIT_SUPREME}
                {TRAIT_INTELLIGENT}
            [/modifications]
        [/unit]

        {GENERIC_UNIT 6 "Air Daemon" 23 15}
        {GENERIC_UNIT 6 "Air Daemon" 23 15}
        {GENERIC_UNIT 6 "Air Daemon" 23 15}
        {GENERIC_UNIT 6 "Air Daemon" 23 15}
        {GENERIC_UNIT 6 "Air Daemon" 23 15}
        {GENERIC_UNIT 6 "Air Daemon" 23 15}

        {SIMPLE_MSG "Ojareth" (_"If I was not required for this ritual, I would have blasted the invaders away with my lightning storms. Anyways, off I go!")}

        {TELEPORT_UNIT (id="Ojareth") 18 2}

        {UNIT_MSG (
            side=3
            canrecruit=yes
        ) (_"Do worry, Lord Ojareth. We shall never give in. Our goal shall be realised!")}

        [place_shroud]
            side=1,2
            x=23
            y=15
            radius=1
        [/place_shroud]
        [reset_fog]
            side=1,2
            x=23,18
            y=15,2
            radius=1
        [/reset_fog]
        [redraw]
        [/redraw]
    [/event]

    [event]
        name="turn 15"

        [remove_shroud]
            side=1,2
            x=23,23
            y=15,10
            radius=1
        [/remove_shroud]
        [lift_fog]
            side=1,2
            x=23,23
            y=15,10
            radius=1
        [/lift_fog]
        [redraw]
        [/redraw]

        {SCROLL_TO 23 15}

        [unit]
            side=6
            x,y=23,15
            id="Mazon"
            name=_"Mazon"
            type="Great Mage"
            gender=male
            {IS_HERO}
            [modifications]
                {TRAIT_SUPREME}
                {TRAIT_INTELLIGENT}
            [/modifications]
        [/unit]

        {GENERIC_UNIT 6 "Fire Daemon" 23 15}
        {GENERIC_UNIT 6 "Fire Daemon" 23 15}
        {GENERIC_UNIT 6 "Fire Daemon" 23 15}
        {GENERIC_UNIT 6 "Fire Daemon" 23 15}
        {GENERIC_UNIT 6 "Fire Daemon" 23 15}
        {GENERIC_UNIT 6 "Fire Daemon" 23 15}

        {SIMPLE_MSG "Mazon" (_"Are these the ones who had vanquished Laraina? To think they made it all this way, to our very gates. Interesting.")}

        {TELEPORT_UNIT (id="Mazon") 23 10}

        {SIMPLE_MSG "Mazon" (_"It matters not. Once the master has been unleashed from the magic shackles that have binded him for over a millennium, the descendants of the people who had once incarcerated him, shall be phased out from existence.")}

        [place_shroud]
            side=1,2
            x=23
            y=15
            radius=1
        [/place_shroud]
        [reset_fog]
            side=1,2
            x=23,23
            y=15,10
            radius=1
        [/reset_fog]
        [redraw]
        [/redraw]
    [/event]

    # event: give gold to keep combat fueled
    [event]
        name="new_turn"
        id=S9A_give_gold_to_combating_sides
        first_time_only=no

        [filter_condition]
            [lua]
                code=<< return wesnoth.current.turn % 4 == 0 >>
            [/lua]
        [/filter_condition]

        [gold]
            side=2
            amount={ON_DIFFICULTY 160 140 120}
        [/gold]
        [gold]
            side=3,4
            amount={ON_DIFFICULTY 140 160 180}
        [/gold]
    [/event]

    # event: sighted guarding enemy leaders
    [event]
        name=sighted

        [filter]
            id="Vale_Subcommander1"
            [or]
                side=1,2
            [/or]
        [/filter]
        [filter_second]
            side=1,2
            [or]
                id="Vale_Subcommander1"
            [/or]
        [/filter_second]

        {SIMPLE_MSG "Vale_Subcommander1" (_"Ah, the invaders have come! I shall destroy and deform your corpses to make more of these night creatures!")}

        [gold]
            side=5
            amount={ON_DIFFICULTY 60 90 120}
        [/gold]
    [/event]

    [event]
        name=sighted

        [filter]
            id="Vale_Subcommander2"
            [or]
                side=1,2
            [/or]
        [/filter]
        [filter_second]
            side=1,2
            [or]
                id="Vale_Subcommander2"
            [/or]
        [/filter_second]

        {SIMPLE_MSG "Vale_Subcommander2" (_"Hello, aragwaithi! You are not advancing beyond this point!")}

        [gold]
            side=9
            amount={ON_DIFFICULTY 60 90 120}
        [/gold]
    [/event]

    [event]
        name=sighted

        [filter]
            id="Dwarf_Commander1"
            [or]
                side=1,2
            [/or]
        [/filter]
        [filter_second]
            side=1,2
            [or]
                id="Dwarf_Commander1"
            [/or]
        [/filter_second]

        {SIMPLE_MSG "Dwarf_Commander1" (_"No passin' 'ere, ya daft git!")}

        [gold]
            side=7
            amount={ON_DIFFICULTY 60 90 120}
        [/gold]
    [/event]

    [event]
        name=sighted

        [filter]
            id="Dwarf_Commander2"
            [or]
                side=1,2
            [/or]
        [/filter]
        [filter_second]
            side=1,2
            [or]
                id="Dwarf_Commander2"
            [/or]
        [/filter_second]

        {SIMPLE_MSG "Dwarf_Commander2" (_"No fur'er, ya big lumps o' meat!")}

        [gold]
            side=8
            amount={ON_DIFFICULTY 60 90 120}
        [/gold]
    [/event]

    # event: sighted nightmare units
    # specifically give hints on how to fight this faction

    # event: entered prison
    [event]
        name="enter_hex"
        first_time_only=yes

        [filter]
            side=1
            x= 7, 8
            y=33,33
        [/filter]

        {UNIT_MSG (x,y=6,35) (_"Oi! You bloody trespassers! This here's a prison, not a playground! Get outta here before I shove a spear up yer...")}
    [/event]

    # event: entering mysterious passage
    [event]
        name="enter_hex"
        first_time_only=yes

        [filter]
            side=1
            x=34
            y=35
        [/filter]

        {UNIT_MSG (speaker=unit) (_"Hey, there is this narrow passage here that goes somewhere. This might be worth investigating.")}
    [/event]

    # event: going deeper
    [event]
        name="enter_hex"

        [filter]
            side=1,2
            x=33,34,33
            y=40,40,41
        [/filter]

        {SIMPLE_MSG unit (_"Well, this has led to a large mud pool. I do not see anything interesting here...")}

        {SIMPLE_MSG unit (_"No, wait...I see a glowing blue sphere!")}

        [earthquake]
        [/earthquake]

        {GENERIC_STATIONED_UNIT 6 "Giant Mudcrawler" 33 43}
        {GENERIC_STATIONED_UNIT 6 "Giant Mudcrawler" 33 42}
        {GENERIC_STATIONED_UNIT 6 "Giant Mudcrawler" 32 41}
        {GENERIC_STATIONED_UNIT 6 "Giant Mudcrawler" 32 42}
        {GENERIC_STATIONED_UNIT 6 "Giant Mudcrawler" 34 41}
        {GENERIC_STATIONED_UNIT 6 "Giant Mudcrawler" 34 42}

        {UNIT_MSG (x,y=33,43) (_"Miiiinnnneee!")}

        {SIMPLE_MSG unit (_"Not for long!")}
    [/event]

    {ITEM_COLD_RES_ORB 1 33 43}

    # event: freeing prisoner units
    # Verra
    [event]
        name="moveto"

        [filter]
            side=1
            x=5,6
            y=35,34
        [/filter]

        {MODIFY_TERRAIN (Urb^Pr/o) (4,5) (34,34)}
        [sound]
            name=mace.wav
        [/sound]
        [redraw]
        [/redraw]

        [delay]
            time=200
        [/delay]

        [modify_unit]
            [filter]
                id="Verra"
            [/filter]
            side=1
            [status]
                unhealable=no
            [/status]
        [/modify_unit]

        {TEAM_COLOR_OVERRIDE (id="Verra") red}

        {SIMPLE_MSG "Verra" (_"Thank you, noble Aragwaithi. I am in your debt. Let me heal up and I shall lend my aid in this battle.")}

        {VARIABLE_OP S9A_prisoners_freed add 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_prisoners_freed equals 3}
            [then]
                [fire_event]
                    name="friends_reunited"
                    id=S9A_friends_reunited
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # Grashen
    [event]
        name="moveto"

        [filter]
            side=1
            x=5,6
            y=36,36
        [/filter]

        {MODIFY_TERRAIN (Urb^Pr\o) (4,5) (36,37)}
        [sound]
            name=mace.wav
        [/sound]
        [redraw]
        [/redraw]

        [delay]
            time=200
        [/delay]

        [modify_unit]
            [filter]
                id="Grashen"
            [/filter]
            side=1
            [status]
                unhealable=no
            [/status]
        [/modify_unit]

        {TEAM_COLOR_OVERRIDE (id="Grashen") red}

        {SIMPLE_MSG "Grashen" (_"Thank you, noble Aragwaithi. I shall lend you my expertise in this battle.")}

        {VARIABLE_OP S9A_prisoners_freed add 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_prisoners_freed equals 3}
            [then]
                [fire_event]
                    name="friends_reunited"
                    id=S9A_friends_reunited
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # Orrida
    [event]
        name="moveto"

        [filter]
            side=1
            x=8,9
            y=35,36
        [/filter]

        {MODIFY_TERRAIN (Urb^Pr\o) (9,10) (35,35)}
        [sound]
            name=mace.wav
        [/sound]
        [redraw]
        [/redraw]

        [delay]
            time=200
        [/delay]

        [modify_unit]
            [filter]
                id="Orrida"
            [/filter]
            side=1
            [status]
                unhealable=no
            [/status]
        [/modify_unit]

        {TEAM_COLOR_OVERRIDE (id="Orrida") red}

        {SIMPLE_MSG "Orrida" (_"Thanks. Now, tell me who needs to be smashed!")}

        {VARIABLE_OP S9A_prisoners_freed add 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_prisoners_freed equals 3}
            [then]
                [fire_event]
                    name="friends_reunited"
                    id=S9A_friends_reunited
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # all drakes freed
    [event]
        name="friends_reunited"
        id=S9A_friends_reunited

        {SIMPLE_MSG "Orrida" (_"Grashen! Verra! You guys have been freed as well!")}

        {SIMPLE_MSG "Grashen" (_"Yes, and it is all thanks to these noble aragwaithi. I have heard stories of your people and you have lived to the stories! Haha!")}

        {SIMPLE_MSG "Verra" (_"We wish to head back home to the Everflame Maw. However, to thank you for freeing us, we shall all assist in this fight.")}
    [/event]

    # event: going near cavern entrances
    [event]
        name="enter_hex"
        first_time_only=yes

        [filter]
            side=1
            x=13,14
            y=51,50
        [/filter]

        {SIMPLE_MSG "Hikaru" (_"This passageway leads into a bigger cavern. I think we might find one of the devices at the end of it.")}
    [/event]

    [event]
        name="enter_hex"
        first_time_only=yes

        [filter]
            side=1
            x=33,34
            y=51,51
        [/filter]

        {SIMPLE_MSG "Soryu" (_"A passageway...perhaps one of the devices might be up ahead?")}
    [/event]

    # event: going near bridges
    [event]
        name="enter_hex"
        first_time_only=yes

        [filter]
            side=1
            x=   30,   31
            y=29-31,29-32
        [/filter]

        {SIMPLE_MSG "Soryu" (_"I think we can find one of the devices if we follow this tunnel.")}
    [/event]

    [event]
        name="enter_hex"
        first_time_only=yes

        [filter]
            side=1
            x=16,15,15
            y=30,30,31
        [/filter]

        {SIMPLE_MSG "Ryuuma" (_"This passage might lead to one of the devices.")}
    [/event]

    # event: warn player that going further into valefolk controlled area
    # is suicide
    [event]
        name="enter_hex"
        first_time_only=yes

        [filter]
            side=1
            x=20-25
            y=27-28
        [/filter]

        {SIMPLE_MSG "Ryuuma" (_"Hikaru, advancing our forces beyond this point appears to be a pointless endeavour. The valefolk fortifications are too strong for us to overcome with our current strength.")}

        {SIMPLE_MSG "Hikaru" (_"Agreed. We should focus on finding the devices that are keeping this cave platform risen.")}
    [/event]

    # death events for each conduit
    # conduit 1
    [event]
        name="die"

        [filter]
            id="Conduit1"
        [/filter]

        {SCROLL_TO $x1 $y1}
        [delay]
            time=200
        [/delay]

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}

        {VARIABLE_OP S9A_conduits_destroy_count sub 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_conduits_destroy_count equals 0}
            [then]
                [fire_event]
                    name=scenario_victory_event
                    id=scenario9A_victory
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # conduit 2
    [event]
        name="die"

        [filter]
            id="Conduit2"
        [/filter]

        {SCROLL_TO $x1 $y1}
        [delay]
            time=200
        [/delay]

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}

        {VARIABLE_OP S9A_conduits_destroy_count sub 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_conduits_destroy_count equals 0}
            [then]
                [fire_event]
                    name=scenario_victory_event
                    id=scenario9A_victory
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # conduit 3
    [event]
        name="die"

        [filter]
            id="Conduit3"
        [/filter]

        {SCROLL_TO $x1 $y1}
        [delay]
            time=200
        [/delay]

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}

        {VARIABLE_OP S9A_conduits_destroy_count sub 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_conduits_destroy_count equals 0}
            [then]
                [fire_event]
                    name=scenario_victory_event
                    id=scenario9A_victory
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # conduit 4
    [event]
        name="die"

        [filter]
            id="Conduit4"
        [/filter]

        {SCROLL_TO $x1 $y1}
        [delay]
            time=200
        [/delay]

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}

        {VARIABLE_OP S9A_conduits_destroy_count sub 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_conduits_destroy_count equals 0}
            [then]
                [fire_event]
                    name=scenario_victory_event
                    id=scenario9A_victory
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # conduit 5
    [event]
        name="die"

        [filter]
            id="Conduit5"
        [/filter]

        {SCROLL_TO $x1 $y1}
        [delay]
            time=200
        [/delay]

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}

        {VARIABLE_OP S9A_conduits_destroy_count sub 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_conduits_destroy_count equals 0}
            [then]
                [fire_event]
                    name=scenario_victory_event
                    id=scenario9A_victory
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # conduit 6
    [event]
        name="die"

        [filter]
            id="Conduit6"
        [/filter]

        {SCROLL_TO $x1 $y1}
        [delay]
            time=200
        [/delay]

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}

        {VARIABLE_OP S9A_conduits_destroy_count sub 1}
        [if]
            {VARIABLE_CONDITIONAL S9A_conduits_destroy_count equals 0}
            [then]
                [fire_event]
                    name=scenario_victory_event
                    id=scenario9A_victory
                [/fire_event]
            [/then]
        [/if]
    [/event]

    # victory event
    [event]
        name=scenario_victory_event
        id=scenario9A_victory

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}
        
        [delay]
            time=200
        [/delay]

        [earthquake]
        [/earthquake]

        # light flashing
        {FLASH_LIGHTNING ()}

        {SIMPLE_MSG "Hikaru" (_"I think that did the trick! Everyone get yourselves away from the cave platform right now!")}

        # grant achievement
        [set_sub_achievement]
            content_for=wol_electrifyre_achievements
            id=WoL_Electrifyre_complete_standard
            sub_id=WoL_Electrifyre_scenario9A
        [/set_sub_achievement]
        #ifdef HARD
        [set_sub_achievement]
            content_for=wol_electrifyre_achievements
            id=WoL_Electrifyre_complete_elite
            sub_id=WoL_Electrifyre_scenario9A_hard
        [/set_sub_achievement]
        #endif

        {ENDLEVEL_VICTORY yes 0}
    [/event]

    # allied leader death event
    [event]
        name="last breath"
        [filter]
            id="Vanleneada"
        [/filter]

        {SIMPLE_MSG "Hikaru" (_"Oh, no! We have let the Deep Elven general die!")}

        {SIMPLE_MSG "Hikaru" (_"The situation seems hopeless now.")}
    [/event]

    [event]
        name="die"
        [filter]
            id="Vanleneada"
        [/filter]

        {ENDLEVEL_DEFEAT}
    [/event]

    # state village ownership
    # order is 3 first as it starts with all
    {STARTING_VILLAGES_ALL 3}
    {STARTING_VILLAGES 1 5}
    {STARTING_VILLAGES 2 5}
    {STARTING_VILLAGES 4 5}
    {STARTING_VILLAGES 5 5}
    {STARTING_VILLAGES 7 5}
    {STARTING_VILLAGES 8 5}
    {STARTING_VILLAGES 9 5}

    # recruit some experienced units
    {RECRUIT_EXPERIENCED_UNITS (2,3,4,5,7,8,9)}

    # limit leader moves of leaders
    {SILENTLY_LIMIT_LEADER_MOVES 2 1}
    {SILENTLY_LIMIT_LEADER_MOVES 3 1}
    {SILENTLY_LIMIT_LEADER_MOVES 4 1}
    {SILENTLY_LIMIT_LEADER_MOVES 5 1}
    {SILENTLY_LIMIT_LEADER_MOVES 7 1}
    {SILENTLY_LIMIT_LEADER_MOVES 8 1}
    {SILENTLY_LIMIT_LEADER_MOVES 9 1}

    {UX_HIGHLIGHT_MISSES_EVENT}

    # player units death event
    {DEFEAT_EVENT:HIKARU}
    {DEFEAT_EVENT:SORYU}
    {DEATH_EVENT:RYUUMA}

    # add gold piles and potions
    {LOOT_CHEST_OF_GOLD 1 ({ON_DIFFICULTY 40 50 60})  9 41}
    {LOOT_CHEST_OF_GOLD 1 ({ON_DIFFICULTY 40 50 60})  6 23}
    {LOOT_CHEST_OF_GOLD 1 ({ON_DIFFICULTY 40 50 60}) 41 23}
    {LOOT_CHEST_OF_GOLD 1 ({ON_DIFFICULTY 40 50 60}) 40 40}
[/scenario]